/// <reference path="../../include.d.ts" />

var request = require('request');
var fs = require('fs');
var cheerio = require('cheerio');
var async = require('async');
var ew = require('node-xlsx');

filePath = 'usa.xlsx';
var excel;
if (fs.existsSync(filePath)) {
    fs.createReadStream(filePath).pipe(fs.createWriteStream('backup.xlsx'));
    excel = ew.parse(fs.readFileSync(filePath));
} else {
    excel = [];
}

var columns = ["Shop_Name", "Shop_Address", "City", "State", "Zipcode", "Telphone", "Email", "Working_Hours", "URL"];
sheet = { name: 'us_delivery', data: [] };
sheet.data.push(columns);

var rows = sheet.data;

excel.push(sheet);



function singleFetch(url, callback) {
    request({ url: url, method: 'GET', gzip: true }, function (err, resp, body) {
        // fs.writeFileSync('body.html', body);

        if (body && (body.length > 10) && (body.indexOf("<html>") == -1)) {
            var ibody = JSON.parse(body);
            var shopName = ibody.listing.name;
            var shopAddress = ibody.listing.address;
            var city = ibody.listing.city;
            var state = ibody.listing.state;
            var zipCode = ibody.listing.zip_code;
            var telePhone = ibody.listing.phone_number;
            var email = ibody.listing.email;
            var workingHours = ibody.listing.hours_of_operation.wednesday;

            var row = [];
            row.push(shopName);
            row.push(shopAddress);
            row.push(city);
            row.push(state);
            row.push(zipCode);
            row.push(telePhone);
            row.push(email);
            row.push(workingHours);
            row.push(url);
            rows.push(row);

        }
        setTimeout(function () {
            console.log(url + ' was done, row ' + row + ' pushed');
            callback();
        }, 1000);
    });

}

var us_deliveries = ["the-gas-station-3","dharma-meds-2","nice-guy-meds-2","parker-green","earth-s-healing-dispensary","phoenix-rising-medical","tucsons-best-420","extract-express","unified-caregivers-of-az","the-humble-co","jointbrosaz","unified-caregivers-of-az-2-2","unifieed-caregivers-of-az","speedy-nugzalez-2","kaya-medical-2","unified-caregivers-of-az-2","greenmarket-selections","garden-of-eden","dream-come-true","dr-feel-good-delivery","710-men-711","thc-thehumboldtconnection-org-2","meds-2-u","acme420-delivery-services","dabtronix","royal-healing-collective","7leafdelivery","chandler-high-quality-collectives","tree-of-life","the-stash-spot","tricomb-therapies","nwa-natural-wellness-association","alternative-green-solutions-2","rehab-delivery-moreno-valley","best-choice-deliveries-8","quality-medical-collective-chino","green-bean-pharm-3","budex-4","mojave-medical-cultivators-club","tricomb-therapies-3","los-angeles-medical-delivery-services","alpha-medic-inc-2","anon-delivery","anaheim-patient-care-delivery-2","goldstar-delivery-service","the-stash-spot-2","buddies-med-express","fly-delivery-3","sticky-icky-delivery","the-lima-collective-inc-lake-arrowhead","alpha-medic-inc-2-2","fly-delivery-sunvalley","fly-delivery-4","private-label-organics","califlower-collective","sgv-med-express-626-200-3587","californiakindness","westsideorganic","101-wellness-delivery","safe-access","safeaccess","green-lantern-express-inc","future-meds-2-2","the-herb-connection-pasadena","alpha-medic-inc-2-4","ez-meds-delivery-2","emerald-phog","kind-patient-services-e4","californiakindness6","budex-delivery-2-3","green-garden","orange-county-s-patient-care","24-7-top-shelf-deliveries-26","the-goddess-delivers-4","undefeated-25-cap","kushman-alternatives-best-in-the-desert","rg-long-beach-delivery","the-goddess-delivers-3","aplusorganics","j-h-care-givers-2","delta11","potdeli-org-salinas-monterey","ocpc-oc-delivery-2","buddiez-vista","swoop","free-wax-2-4","magic-budz-2-5","530greentrees-delivery","rite-greens-santa-ana","deliver-bud-2","weedidit-association","gitmos-discreet-delivery","the-mint-leaf-dana-point","california-kindness-2-2","holistic-approach-wellness","citadel-alternative-care","lakeside-remedy","pavo-pacific-collective-paso-robles","premium-meds-2-37","a-cut-above-delivery","bayshoremedical","organix-delivery-tustin","green-nectar-delivery-temecula","pure-green-delivery","lake-forest-organic","buds-direct-3","bennysfarm3","house-of-kush-2-4","php-wellness-delivery","safe-access-2-6","exclusive-services-2-8","dam-2","dr-vapemen-s-2","exclusive-services-2-3","true-meds","fast-n-friendly-open-late-2-12","420-express-421-426","the-crown-collective-delivery-only-3","organix-delivery-anaheim","elite-420","fast-and-friendly-san-pedro-open-late","secretgarden-2","holistic-essentials-girl-scout-cookies-is-back","green-cuisine-delivery-ventura","benny-s-farm-pacific-palisades","organix-delivery-mission-viejo","kind-solutions","green-line-delivery-alameda","left-coast-collective-2-3","georgia-cannabis-org","david-s-cbd-dispensary","cambridge-care-givers","metrowest-care","michorganics","buds-r-us-delivery-2","weedies-2-2","budex-delivery-2-3-2","medex","nu-wave-medz","good-life-delivery-2","ant-farm-compassion-club","instagrams","green-loop","happy-420-dispensary","buds-r-us-delivery","nugs-on-the-run","mobilemedz1","snoops-doggz-smoke-relief-2","green-nuggets","the-caviar-hut","champion-meds","michorganics-2","kelly-mobile-caregivers","door-to-door-meds","antfarm","cannabis-station","the-happy-cab","ant-farm-compassion-club-2","highlife-meds","patients-4-patients-reno","las-vegas-releaf","las-vegas-releaf-2","las-vegas-releaf-2-3","las-vegas-releaf-2-2","pisos","silver-state-relief-2","oasis-medical-cannabis","oasis-medical-cannabis-2","sierra-wellness-connection","oasis-cannabis-delivery","oasis-cannabis-delivery-2","blc-delivery","apache-organics","oregon-green-society-1","green-queen-organic-horticulture-2-2","green-legacy-fine-cannabis","fullys-wildflowers"];

// var us_dispensary = ["arizona-natural-selections-of-scottsdale","glendale-greenhouse","organica-patient-group","sunflower-meds-mesa","the-downtown-dispensary","nevada-medical-marijuana-2","total-accountability-patient-care","greenhouse-of-flagstaff","hana-kingman","cave-creek-cannabis","superior-organics-2-2","fusion-dispensaries-of-wellton","the-medicine-room","yavapai-herbal-services-prescott-valley","white-mountain-health-center","desert-bloom-re-leaf-center","reef-dispensary-gilbert","leaf-life","green-pharms-of-flagstaff","arizona-natural-remedies","kompo-care-2","bc-wellness-center","sierra-vista-phytotherapeutics-2","farm-fresh-medical-marijuana-dispensary","arizona-grass-roots-dispensary-mayer","valley-of-the-sun-medical-dispensary-goodyear-phoenix","botanica-tucson","monarch-scottsdale","trumed-premier-dispensary-arcadia-phoenix","herbal-wellness-center-chandler","ponderosa-releaf","yavapai-herbal-cottonwood","zen-the-clear-concentrate","golden-leaf-wellness-2","mohave-green","earth-s-healing-tucson","the-giving-tree-mesa-location","natures-az-medicines-phoenix","valley-healing-group-2-2","hana-green-valley","mmj-apothercary-2","herbal-wellness-center","arizona-organix","sunflower-meds","purplemed-healing-center-2","parc-dispensary-phoenix","the-giving-tree-2","desert-rose-phoenix","natures-leaf-collective-2-2","central-ramdies","mega-wellness-center","ccc-3","420-tailor-shop","kush-kingdom-2-6","bonafide-group-collective","spring-valley-storefront","one-stop-healers","new-age-compassion-care","la-mart","pot-of-gold","presidential-collective-2","bmc-2","whittierhotbox","east-la-caregivers-2","greenmart-the-superstore","southwest-patient-group","greenleaf-collective-2","jah-healing-caregivers-2-2-3-2-2-2","420-manchester","kush-palace-pre-ico-best-daily-deals","dank-of-america-3","showgrow-ramona","mmd","15shatter10og7edible","sungrow","vhc-valley-herbal-center-sun-valley-91352","showgrow-santa-ana","sugar-shack","v-g-collective","organic-green-treatment-center","thc-the-healing-center-needles-walk-in","the-high-church","cci-medical-group-coachella","strange-therapy-solutions","mjinc-san-bernardino","venice-medical-center","mr-naturals","premium-pacific","chubby-s-med-house","t-h-c-perris","mr-nice-guy-collective","e-c-c-ease-compassion-collective","natural-herbal-pain-relief","greenwolf-la","the-laughing-leaf-2","green-acres","concentrate-leader","g-mile","diamond-hills-reserve","limitless-care-collective","beach-center","ligthts-out-wellness","harvest-collective-2-2-2-2","telegraph-health-center","the-holistic-center-modesto","highlands-health-and-wellness-collective","venice-beach-care-center","purple-star-md","mercy-wellness","blue-stone-group","off-the-pier","99-high-tide-collective","the-clinic-walk-ins-welcome","dc-collective","gld","alternative-herbal-health-services","onestopoc-2-5","green-nectar-all-8ths-are-4-0-gs-2","the-kind-center-inc","green-remedy","onac-of-east-bay","the-high-side","apothekare","m-c-c-express","heaven","stockton-patient-clinic","mallgreens","upland-cannabis-club-2","city-wellness-2","monterey-bay-alternative-medicine","elementalwellness","greeneath710","11th-st-well-health","organic-greens-collective","true-compassion-cooperative","tahoewellnesscooperative","cookies-sf","green-mammoth","kure-wellness-2","rainbow-group","collective-efforts-grand-open","leave-it-to-nature","the-dispensary-2-2","orange-tree-top","wonderland-25-cap-collective","chula-vista-patients-association","calireleafcaregivers","htc-high-tide-church-grand-opening","cannabicare","maggies-farm-pueblo-east","the-green-stop","the-clinic-highlands","boulder-fresh-baked-dispensary","organix-adult-use","the-clinic-colorado-denver","animas-herbal-wellness-center","trinidads-higher-calling-u","the-clinic-on-wadsworth","native-roots-summit-medical-frisco-silverthorne","native-roots-apothecary","organic-alternatives","native-roots-vail-2","strawberryfields","terrapin-care-station-aurora-33rd-ave-recreational-adult-use","mindful","rocky-mountain-remedies-adult-use","lacontescbd","buds-ltd","the-clinic-on-colfax-recreational","headquarters-cannabis-company-recreational-longmont","native-roots-littleton","mountain-medicinals-wellness-center-recreational","native-roots-aspen","natural-mystic-wellness-center","infinite-wellness-center-2","pueblo-west-organics-2","sante-alternative-wellness","the-64-store","faragosi-farms","fox-cannabis-co","breckenridge-organic-therapy","the-station-dispensary-boulder","bud-med-health-centers-patients-choice-partner","lacontes-clone-bar-dispensary-central","natures-medicine-salida","rinosupply","sedgwick-alternative-relief-colorado","native-roots-longmont-medical","green-man-cannabis-recreational-2","herbal-bliss","roots-rx-aspen","lightshade-sheridan-recreational","maggie-s-farm-pueblo-west-adult","medicine-man-aurora","lightshade-adult-use-2-peoria","the-secret-stash","native-roots-dillon","natural-remedies-adult-use","solace-meds-2","the-highway-adult-use","native-roots-colorado-springs","green-tree-berthoud","natures-spirit","3d-cannabis-center-salida","green-tree-medicinals-boulder","green-tree-medicinals-formerly-nature-s-medicine-of-longmont","pateints-choice-of-colorado","mindful-colfax","cannaco-2","altitude-wellness-center-recreational","420-green-genie","gs-warehouse-dispensary","patients-choice-of-colorado-adult-use","lightshade-6th-ave","maggie-s-farm-2","sacred-seed-recreational","dr-releaf-inc-2-2","highland-health","ballpark-holistic-dispensary","mindful-medicine-colorado-springs","headquarters-cannabis-company-medical-mmc-longmont","colorado-cannabis-cabin","high-country-healing-2-recreational-alma","mmj-america-boulder-recreational","icebox-flower","new-age-medical-adult-use","patients-choice-2","fiddlers-green","sacred-seed-denver","maggie","natural-remedies-lodo","freedom-road","lightshade-labs","the-farm","cannasseur","northern-lights-natural-rx","new-amsterdam-organics-2-2","kind-care-of-colorado-2","silver-stem-fine-cannabis-s-denver-medical-2","the-herbal-cure-recreational","soco","magnolia-road-cannabis-co-recreational","the-spot-420","the-spot-420-2","lightshade-sheridan-medical","native-roots-edgewater","cannamart","green-man-cannabis-recreational","arrow-alternative-care","the-healing-corner","thames-valley-alternative-relief-llc","trulieve","pdi-medical","natures-care","new-age-care","floramedex","thrive-harrisburg","the-clinic-mundelein","thrive-anna","midwest-compassion-center","dispensary-33","mindful-medical-marijuana-dispensary","pharmacannis-2","medmar-rockford-llc","pharmacannis-2-3","pharmacannis","earthmed-2","phoenix-botanical","salveo-health-wellness","elevele","pharmacannis-2-2","trinity-compassionate-care-centers","mapleglen-care-center","new-world-organics-2","new-england-treatment-access","neta-brookline","patriot-care-boston","michigan-wellness-group","helpinghandholisticcenter","cannacure","green-pharm-clinic","a2wc","shakeandbake","pure-west","pure-options","michigan-organic-solutions","u-p-caregivers","superior-genetics-northern-michigan","the-green-room-4","firehouse-2-2","green-door-alternative","gb-meds-the-green-bean-2","fuego","herbal-solutions-ypsi","the-kushion-provisions-center-kushion-prov","bulldog-provisioning-center","lakeshore-alternatives","far-east-holistic-center","3rd-coast-mi","the-jazz-club","mindright-llc","liv-wellness-cafe","the-sweet-leaf-llc","313-herb","tru-releaf","5092wellness","great-lakes-helping-hands-williamsburg","pure-michigan-wellness-center","bigfoot-wellness","cannabliss-wellness-center","420-dank","lake-effect","plymouth-holistic-health","suite-b-provisionary-center-2-2","green-crush","arborsidecompassion","clover-land","315north","gb-meds","michigan-organix","cannibis-world-wellness-center","first-class-wellness-center","michigan-chronic-relief","bhhc","cannabliss-compassionate","d-l-s-medicinal-exchange","treecity-health-collective","elite-detroit","the-third-day","gb-meds-the-green-bean","connoisseur-collective-2","natures-s-alternative","all-natural-collective-2","tincture-town-2-2","the-reef-medical-center","motown-meds","greenside-collective","superior-genetics-2-2","ann-arbor-apothecary","herbal-remedies-mi","bloom-city-club","green-field-collective","sativa-detroit","house-of-dank-313","old-27-wellness","puff-detroit","the-clinic-detroit","wizemedz","cornerstone-wellness","pure-cannabis","greener-crossing","cannabis-society-of-detroit","treetop-therapy-detroit","the-flower-shop-detroit","bank-of-buds","budzrus-provision-center","healing-tree-wellness-center","shucky-farms","holistic-earth","green-river-meds","starbudsdetroit","lucky-s-wellness","buds-r-us-2-3","greenwave-dispensary","area-51","homegrown-2","detroit-budz","emerald-city-2","detroit-s-t-h-c","doghouse","tribute","cedar-street-mmmp","dream-detroit","kind-lansing","nevada-medical-marijuana","show-grow-las-vegas","sahara-wellness","nevada-medical-marijuana-2","silver-state-relief","essence-dispensary-the-strip","essence-west","sierra-wellness-connection","the-apothecary-shoppe","essence","inyo-fine-cannabis-dispensary","reef-dispensaries-2","mohave-green","nevada-wellness-center","las-vegas-releaf","valley-healing-group-2-2","oasis-medical-cannabis","euphoria-wellness","the-grove-2-2","silver-sage-wellness","blum-las-vegas","cannacopia-las-vegas-medical-marijuana-center","blackjack-collective","thrive-cannabis-marketplace-downtown","the-apothecarium-2","medizin","breakwater-treatment-wellness","pharmancannis-bronx","etain-yonkers","etain-kingston","pharmancannis-albany","etain-albany","pharmancannis-liverpool","etain-syracuse","pharmancannis-amherst","bloomfield-industries-lake-success","bloomfield-industries-salina","bloomfield-industries-buffalo","cg-corrigan-gulton-2","ultra-health-santa-fe","cg-corrigan-2","southwest-organic-producers-2","hicascade-se-pdx","happy-leaf","blue-sky-of-portland-1","sweet-relief-natural-medicine","blooming-deals-by-cannabis-nation","west-coast-organics","oregon-bud-company-clackamas","oregon-weedery","skunkrx","tj-s-organic-provisions","mountain-view-naturals","shango-hillsboro","the-new-amsterdam","hi-cascade-2","silver-stem-cannabis","brothers-portland","puddletown-organics-2-2","natural-rxemedies-east","portland-medicine-pot","gorge-greenery","mandy-s-med-club","the-green-planet","madrone-cannabis-club","sweet-relief-port-astordam","shango-cannabis","club-sky-high-2","5th-lmnt","harborside-health-center-portland","the-green-remedy","flowr-of-lyfe","rogue-river-herbal-pain-management-center-2","cannabis-nation","chalice-farms","mindrite-dispensary","phresh-cannabis","oregon-bud-company-beaverton-2","treehouse-collective-portland","neighborhood-wellness","canna-daddys","kaya-shack-salem","tamerans-dispensary","sweet-relief-tillamook","south-coast-dispensaries","canna-royal","sweet-relief-portland","the-herbary-oregon","shango-cannabis-molalla","kush-gardens-3-2","satchel","shango-cannabis-portland","chalice-farms-tigard","oregon-medical-grade-rainier","hi-cascade-eugene","oregon-coast-cannabis","nbhh","alberta-green-house-2","house-of-leaves-2-3","the-stone-age-pharmacy-pdx","high-tide-wellness","grohi-station","kaya-shack","good-karma-springfield","urban-farmacy-patient-resource-center","twenty-after-four-wellness-center","portland-extracts","bud-bros-2","green-mart","chalice-farms-airport","buddha-s-wellness-center-llc","tru-cannabis-portland","americanna-rx","sweet-tree-farms","eugreen-health-center","natural-rxemedies-2","kind-heart-collective-2","shango-cannabis-2-2","jamaica-joel-s","apothecaria","plane-jane-s","k9-chronic-llc","rare-earth-organics-2-2","summit-medical-compassion-center","greenleaf-compassionate-care-center","thomas-c-slater-compassion-center","champlain-valley-dispensary-2","healthy-living-cooperative","clear-choice-cannabis-recreational","cannabisclubcollective","herban-legends","the-healing-center-2-2","satori-cured","fillabong","freedom-market-recreational","green-theory","cannabis-central","greenhead-cannabis-2","emerald-haze-cannabis-emporium","sweet-green-nw","longview-freedom-market-recreational","mary-mart","cinder-spokane-valley","greenside-des-moines","the-herbery","higher-leaf-2","the-vault","rainier-wellness-center","cinder","highway-7-recreational","new-vansterdam-2","the-evergreen-market","2020-solutions-recreational-north-bellingham","have-a-heart-skyway","mari-j-s-highway-pot-shop","the-herbery-i-5","dank-s-wonder-emporium","urban-bud-rec","two-five-trees","canna-4-life","sticky-s-pot-shop","station-420-verde-valley","2020-solutions-recreational","mr-doobees-natural-high-store","greenfield-company","goodbudstore","have-a-heart-cafe","fweedom-collective-seattle","smokane","a-bud-leaf","trees-collective","high-society-everett","thegreendoor","420-friendly","marijuana-mart","cannabis-glass-recreational","420-holiday","420-spot-shop","locals-canna-house","cannarail-station","takoma-wellness-center-2-2","herbal-alternatives-ii","national-holistic-healing-center","capital-city-care"];

// var canada_delivery = ["escarpment-wellness-mail-order-2-9","first-class-medicinal-mail-order-2-4","potent-industry-2","dho-medicinal-2-12","xpress-holistics","escarpment-wellness-mail-order-2-12","first-class-medicinal-mail-order-2-6","ganja-express-2-4","potent-industry-mail-order-2-11","high-grade-aid-mail-order-2","xpress-holistics-2-2","the-national-compassion-club-mail-order","bestbudcanada-ca-2-3","dho-medicinal-2-3","escarpment-wellness-mail-order-2-6","first-class-medicinal-2-14","dho-medicinal-2-13","xpress-holistics-mail-order-2-3","escarpment-wellness-mail-order-2-15","first-class-medicinal-mail-order-2-15","mc-medical-dispensary","escarpment-wellness-mail-order-2-13","first-class-medicinal-mail-order-2-7","potent-industry-mail-order","dho-medicinal-2-5","bestbudcanada-ca-2-4","high-grade-aid-mail-order","yhm-meds-mail-order-2-5","mmjdirect-co","the-national-compassion-club-mail-order-2","xpress-holistics-2-4","sky-medz-2","escarpment-wellness-mail-order-2-18","first-class-medicinal-mail-order-2-16","dho-medicinal-2-6","xpress-holistics-2-5","potent-industry-mail-order-2","sky-medz","escarpment-wellness-mail-order-2-16","first-class-medicinal-mail-order-2-12","mr-nice-guy-2-5","first-class-medicinal-mail-order-2-11","escarpment-wellness-2-14","dho-medicinal-2-14","bestbudcanada-ca","yhm-meds-mail-order","xpress-holistics-2-6","weleaf-2-6","cottage-dispatch-2","first-class-medicinal-mail-order-2-22","edit-escarpment-wellness-mail-order-2-6","sky-medz-2-5","escarpment-wellness-mail-order-2-8","first-class-medicinal-mail-order-2-9","dho-medicinal-2-4","xpress-holistics-2-8","potent-industry-mail-order-2-2","ganja-express-2-9","sky-medz-2-2","first-class-medicinal-mail-order-2-24","edit-escarpment-wellness-2-4","dho-medicinal-2-15","xpress-holistics-2-9","first-class-medicinal-mail-order-2-13","escarpment-wellness-mail-order-2-19","dho-medicinal-2-16","xpress-holistics-mail-order-2-10","budding-botanicals","dho-medicinal-2-17","first-class-medicinal-mail-order-2-25","xpress-holistics-2-11","first-class-medicinal-mail-order-2-26","edit-escarpment-wellness-mail-order-2-3","escarpment-wellness-2-2","first-class-medicinal-mail-order-2","dho-medicinal-2-2","potent-industry-mail-order-2-3","high-grade-aid-2","ganja-express-2-3","yhm-meds-mail-order-2-4","sky-medz-2-3","bestbudcanada-ca-2-5","the-national-compassion-club-mail-order-2-5","xpress-holistics-2-12","escarpment-wellness-mail-order-2-5","first-class-medicinal-mail-order","dho-medicinal-2-18","xpress-holistics-2-13","first-class-medicinal-mail-order-2-27","edit-escarpment-wellness-mail-order-2-2","escarpment-wellness-mail-order-2-10","first-class-medicinal-mail-order-2-8","xpress-holistics-2-14","first-class-medicinal-mail-order-2-28","edit-escarpment-wellness-mail-order-2","escarpment-wellness-mail-order-2-4","first-class-medicinal-mail-order-2-3","high-grade-aid-7","ganja-express-2-5","the-national-compassion-club-mail-order-2-3","xpress-holistics-2-15","dho-medicinal-20","cottage-dispatch","first-class-medicinal-mail-order-2-23","edit-escarpment-wellness-mail-order-2-5","xpress-holistics-2-7","escarpment-wellness-2-17","first-class-medicinal-mail-order-2-17","dho-medicinal","xpress-holistics-2-16","potent-industry-mail-order-2-4","escarpment-wellness-mail-order-2-20","first-class-medicinal-mail-order-2-18","dho-medicinal-2-7","xpress-holistics-mail-order-2-17","potent-industry-mail-order-2-5","the-saskatchewan-compassion-club-mail-order","escarpment-wellness-mail-order-2-22","first-class-medicinal-mail-order-2-19","escarpment-wellness-mail-order-2-23","first-class-medicinal-mail-order-2-20","dho-medicinal-2-8","xpress-holistics-2-18","potent-industry-mail-order-2-6","best-budcanada-ca","first-class-medicinal-mail-order-2-29","edit-escarpment-wellness-mail-order","first-class-medicinal-2-30","escarpment-wellness-mail-order-2-25","first-class-medicinal-1","escarpment-wellness-mail-order","dho-medicinal-2","potent-industry-mail-order-2-7","twisted-smoke-haberdashery","bestbudcanada-ca-2-6","ganja-express-2-2","sky-medz-mail-delivery","yhm-meds-2-3","mmjdirect-co-2-2","xpress-holistics-mail-order-2-19","first-class-medicinal-mail-order-2-5","escarpment-wellness-2-7","dho-medicinal-2-19","potent-industry-mail-order-2-8","twisted-smoke-haberdashery-2","ganja-express-2","high-grade-aid-6","yhm-meds-2","xpress-holistics-mail-order-2-23","first-class-medicinal-mail-order-2-10","escarpment-wellness-mail-order-2","high-grade-aid-5","potent-industry","dho-medicinal-2-9","ganja-express","mmjdirect-co-2","xpress-holistics-2-20","treemo-2","bestbudcanada-ca-2-2","first-class-medicinal-2-31","escarpment-wellness-2-24","first-class-medicinal-mail-order-2-2","potent-industry-mail-order-2-9","escarpment-wellness-mail-order-2-3","dho-medicinal-2-10","bestbudcanada-ca-2","xpress-holistics-2-21","escarpment-wellness-mail-order-2-21","first-class-medicinal-mail-order-2-21","escarpment-wellness-2-11","first-class-medicinal-2","potent-industry-mail-order-2-10","high-grade-aid-mail-order-2-2","the-national-compassion-club-mail-order-2-2","dho-medicinal-2-11","xpress-holistics-2-22"];

// var canada_dispensary = ["sunrise-medicinal","med-west","orillia-go-green","canada-bliss-herbals-bracebridge-2-4","leaf-compassion-chemainus-rd","warmland","temple-medicinal-oshawa","green-street-medical-society-2","urban-med-dispensary","tasty-budd-s-cole-harbour","auntie-s-health-wellness-centre","the-farm-assists-medical-cannabis-resource-centre","tasty-budd-s-sackville","burlington-s-first","mmj-canada-hamilton","royal-farmacy","the-medicine-cabinet-2-2","natural-green-compassion","pacifico-health-and-wellness","delta-nine","mmj-total-health-care","hemp-wellness-vernon","okanagan-medicinal-society","black-crow-herbal-solutions-vernon","the-herbal-health-centre","kw-dispensary","waterloo-organix","organix-compassion","green-well-compassion","urban-earth-farmacy-1","royal-city-wellness","motacan-compassion-society","healing-health-compassion","green-era-medicinal","tasty-budd-s-moncton","hbb-medical-inc-moncton-2","clinique-la-croix-verte-2-2","west-side-alternatives","medicanna-nanaimo-2","weemedical-dispensary-society-2-2","canna-clinic-nelson-2","leaf-cross-health-society","magna-terra-health-services-2","capital-city-cannabis","leaf-compassion-johnston-rd","leaf-compassion-mcphillips-ave","castle-naturals","medijuana-dispensary-sooke-rd","grass-roots-medicinal","wee-medical-squamish","99-north-squamish","coastal-meds-420-hemp-shop","canna-clinic-kensington","zen-zoo","canna-clinic-yonge","canna-clinic-broadview","green-panda-cannabis-dispensary-yonge","mother-earth-dispensary","pure-releaf-queen","eden-east-york","canadian-benevolent-dispensary","mmj-canada-yorkville","evergreen-medicinals-yonge","canadian-benevolent-dispensary-kensington-2","cannawide-dispensary-top-shelf","cannada-holistic-centers","the-toronto-dispensary","cannawide-dispensary-kensington-2","potluck-apothecary-dispensary-2","canada-bliss-herbals-2-3","647-medicinals","s-w-e-d-society-danforth","eden-bellwoods","canna-clinic-dundas","bellwoods-dispensary","pure-releaf-dundas-2","twisted-smoke-haberdashery","canna-clinic-queen","the-care-center","eden-dundas","canadian-green-dispensary-and-holistic-services","green-buddha-medicinals","mmj-canada-bloor-court-village","the-healing-centre","weed-the-north-eglinton","cannalife-2","queens-of-cannabis","evergreen-medicinals-dundas","bloor-court-wellness-centre","canna-clinic-ossington","toronto-healing-center","true-compassion-toronto-dispensary","canna-clinic","canna-clinic-4th-street","medicanna","canna-city","mmj-canada-sunset","natural-releaf-society","chronic-hub-social-club-society","eden-of-eden","green-cross-society-of-main-street","the-herb-co","wealth-shop","cafe-420-2","vancity-weed","canna-mart","buddha-barn-2","apollo-medical-centre","green-panda-dispensary-robson-street","sunrise-wellness-foundation-kingsway-2","cannawide-dispensary","aura-health-studio-dispensary","herban-art-collective","cloud-9-medicinal-society","nature-s-aid-medicinal-dispensary","pineapple-express-dispensary","five-star-medicinal-dispensary","the-green-hart-health-wellness","buds-leaves","potent-industry-2","remedy-medicinals-2","alternative-aromatic-apothecary","ocean-grown-medicinal-society-2"];


var urls = [];

process.on('exit', function() {
    var buffer = ew.build(excel);
    fs.writeFileSync(filePath, buffer);
});

us_deliveries.forEach(function (value, index, array) {
    urls.push("https://weedmaps.com/api/web/v1/listings/" + value + "/menu?type=delivery")
});

async.mapLimit(urls, 3, function (url, callback) {
    singleFetch(url, callback);
}, function (err) {
    if (err) console.log(err);
    var buffer = ew.build(excel);
    fs.writeFileSync(filePath, buffer);
});

